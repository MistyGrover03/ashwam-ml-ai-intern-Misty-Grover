# Evidence-Grounded Extraction & Evaluation

## ğŸ“Œ Overview

This project provides a **strict, evidence-based evaluation framework** for information extracted from **human-written health journals**.

The system evaluates predicted extractions against human-annotated gold data using **exact textual evidence**, ensuring that **no unsupported or hallucinated information** is counted.

> **Only what is explicitly written in the journal can be scored.**

---

## ğŸ¯ Core Objectives

- Evaluate extracted health-related facts safely
- Enforce exact evidence grounding
- Avoid hallucinations and assumptions
- Provide transparent and reproducible metrics

---
ğŸ“‚ Project Structure

.
â”œâ”€â”€ data/
â”‚   â”œâ”€â”€ journals.jsonl
â”‚   â”œâ”€â”€ gold.jsonl
â”‚   â””â”€â”€ sample_predictions.jsonl
â”‚
â”œâ”€â”€ ashwam_eval/
â”‚   â”œâ”€â”€ cli.py          # Command-line interface
â”‚   â”œâ”€â”€ extract.py      # Data loading utilities
â”‚   â””â”€â”€ score.py        # Evaluation logic
â”‚
â”œâ”€â”€ out/
â”‚   â”œâ”€â”€ score_summary.json
â”‚   â””â”€â”€ per_journal_scores.jsonl
â”‚
â””â”€â”€ README.md


yaml
Copy code

---

## ğŸ“„ Input Files

### `journals.jsonl`
Contains the original journal text written in natural language.  
This file acts as the **source of truth for evidence validation**.

```json
{
  "journal_id": "J001",
  "text": "I felt anxious and had trouble sleeping last night."
}
gold.jsonl
Human-annotated reference data used only for evaluation.
Each journal contains multiple labeled items with exact evidence spans.

json
Copy code
{
  "journal_id": "J001",
  "items": [
    {
      "domain": "emotion",
      "evidence_span": "felt anxious",
      "polarity": "present",
      "arousal_bucket": "high",
      "time_bucket": "today"
    }
  ]
}
sample_predictions.jsonl (Optional)
Example predictions used to test the evaluation pipeline.
No real model inference is required.

json
Copy code
{
  "journal_id": "J001",
  "items": [
    {
      "domain": "emotion",
      "evidence_span": "felt anxious",
      "polarity": "present",
      "arousal_bucket": "high",
      "time_bucket": "today"
    }
  ]
}
ğŸ§¾ Prediction Representation
Internally, predictions are flattened into one JSON object per extracted fact:

json
Copy code
{
  "journal_id": "J001",
  "domain": "emotion",
  "evidence_span": "felt anxious",
  "polarity": "present",
  "arousal_bucket": "high",
  "time_bucket": "today"
}
Rules
One object represents one fact

evidence_span must be copied exactly from the journal

Predictions without evidence are discarded

âš™ï¸ Evaluation Logic
A predicted item is considered a True Positive only if:

journal_id matches

domain matches

evidence_span overlaps with the gold evidence

Not Used
âŒ Label matching

âŒ Synonym matching

âŒ Semantic inference

Evaluation is strictly evidence-driven.

ğŸ“Š Metrics Computed
Core Metrics
Precision

Recall

F1-score

Attribute Accuracy
Polarity accuracy

Bucket accuracy (intensity/arousal + time)

Evidence Validation
Evidence coverage rate

Percentage of predictions whose evidence exists in the journal text

ğŸ›¡ï¸ Hallucination Prevention
The system enforces safety through:

Discarding predictions without evidence

Verifying evidence spans against journal text

Scoring only evidence-backed facts

This guarantees zero hallucinated evaluation.

â–¶ï¸ Running the Evaluation
Run the following command from the project root:

bash
Copy code
python -m ashwam_eval.cli run --data ./data --out ./out
What This Command Does
Loads journal, gold, and prediction data

Executes evidence-based matching

Computes evaluation metrics

Writes output files to the out/ directory

ğŸ“ Output Files
out/score_summary.json
Contains overall evaluation metrics:

json
Copy code
{
  "precision": 0.75,
  "recall": 0.60,
  "f1": 0.67,
  "polarity_accuracy": 0.80,
  "bucket_accuracy": 0.70,
  "evidence_coverage": 1.0
}
out/per_journal_scores.jsonl
Journal-level performance breakdown:

json
Copy code
{
  "journal_id": "J001",
  "tp": 2,
  "fp": 1,
  "fn": 0
}
ğŸ“‰ Why Recall May Be Low
Low recall is expected and intentional.

The system does not guess

It avoids unsupported extraction

It prioritizes safety over coverage

Lower recall reflects safe abstention, not failure.