Evidence-Grounded Extraction & Evaluation (Exercise A)
======================================================

Overview
--------
This project checks extracted information from health journals using exact text from the journal as evidence.

Instead of relying on canonical labels, each extracted item must be directly supported by an exact quote from the journal text.

The goal is to ensure evaluation is objective, safe, and reproducible, even when the language is messy or informal.


Input Data
----------

1. journals.jsonl
   Raw journal entries written in natural language.
   This file acts as the source of truth for all evidence spans.

2. gold.jsonl
   Human-annotated reference data.
   Each journal contains multiple semantic items with:
   - domain
   - evidence_span
   - polarity
   - intensity / arousal bucket
   - time bucket

3. sample_predictions.jsonl 
   Example outputs from a hypothetical model.
   This file is used only to test the evaluation pipeline.
   Running a real model is not required.


Extraction Format
-----------------

Each extracted object is represented as a flat JSON item:

{
  "journal_id": "J002",
  "domain": "emotion",
  "evidence_span": "Feeling anxious in chest",
  "polarity": "present",
  "arousal_bucket": "high",
  "time_bucket": "today"
}

All fields are either constrained enums or exact text copied directly from the journal.


Evaluation Logic
----------------

A predicted item is matched to a gold item if:
- journal_id matches
- domain matches
- evidence_span overlaps with the gold evidence

The following metrics are computed:
- Precision / Recall / F1
- Polarity accuracy
- Bucket accuracy (intensity/arousal + time)
- Evidence coverage rate

Predictions without valid evidence spans are discarded to avoid hallucination.


Running the Code
----------------

python -m ashwam_eval.cli run --data ./data --out ./out


Output Files
------------

The command generates the following files:

- out/score_summary.json
- out/per_journal_scores.jsonl


Notes
-----

Recall may be lower when predictions are available for only a subset of journals.
This reflects safe abstention rather than over-extraction.
